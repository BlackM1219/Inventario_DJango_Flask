{% extends 'productos/base.html' %} {% block title %}Lista de Productos{% endblock %} {% block extra_css %}
<style>
    .search-box {
        margin-bottom: 20px;
    }

    .search-box input {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 14px;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }

    th,
    td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid #ddd;
    }

    th {
        background: #f8f9fa;
        font-weight: bold;
    }

    tbody tr:hover {
        background: #f8f9fa;
    }

    .badge {
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.85em;
    }

    .badge-ok {
        background: #d4edda;
        color: #155724;
    }

    .badge-bajo {
        background: #fff3cd;
        color: #856404;
    }

    .badge-agotado {
        background: #f8d7da;
        color: #721c24;
    }

    .actions {
        display: flex;
        gap: 5px;
        flex-wrap: wrap;
    }

    .btn-small {
        padding: 6px 12px;
        font-size: 0.85em;
    }

    .empty-message {
        text-align: center;
        padding: 40px;
        color: #6c757d;
    }
</style>
{% endblock %} {% block content %}
<h2>Inventario de Productos</h2>

<div class="search-box">
    <input type="text" id="searchInput" placeholder="Buscar productos..." onkeyup="filtrar()">
</div>

{% if productos %}
<table id="tablaProductos">
    <thead>
        <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Categoría</th>
            <th>Precio</th>
            <th>Stock</th>
            <th>Vencimiento</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
        {% for producto in productos %}
        <tr>
            <td>{{ producto.id }}</td>
            <td>{{ producto.nombre }}</td>
            <td>{{ producto.categoria }}</td>
            <td>Q{{ producto.precio }}</td>
            <td>
                {% if producto.cantidad > 10 %}
                <span class="badge badge-ok">{{ producto.cantidad }}</span> {% elif producto.cantidad > 0 %}
                <span class="badge badge-bajo">{{ producto.cantidad }}</span> {% else %}
                <span class="badge badge-agotado">Agotado</span> {% endif %}
            </td>
            <td>{{ producto.fecha_vencimiento|default:"N/A" }}</td>
            <td>
                <div class="actions">
                    <a href="{% url 'detalle_producto' producto.id %}" class="btn btn-primary btn-small">Ver</a>
                    <a href="{% url 'editar_producto' producto.id %}" class="btn btn-warning btn-small">Editar</a>
                    <form method="post" action="{% url 'eliminar_producto' producto.id %}" style="display: inline;"
                        onsubmit="return confirm('¿Eliminar este producto?');">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger btn-small">Eliminar</button>
                    </form>
                </div>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div class="empty-message">
    <h3>No hay productos</h3>
    <p>Agrega tu primer producto al sistema</p>
    <a href="{% url 'crear_producto' %}" class="btn btn-primary">Agregar Producto</a>
</div>
{% endif %} {% endblock %} {% block extra_js %}
<script>
    function filtrar() {
        const input = document.getElementById('searchInput');
        const filter = input.value.toUpperCase();
        const table = document.getElementById('tablaProductos');

        if (!table) return;

        const tr = table.getElementsByTagName('tr');

        for (let i = 1; i < tr.length; i++) {
            const tdNombre = tr[i].getElementsByTagName('td')[1];
            const tdCategoria = tr[i].getElementsByTagName('td')[2];

            if (tdNombre && tdCategoria) {
                const txtNombre = tdNombre.textContent;
                const txtCategoria = tdCategoria.textContent;

                if (txtNombre.toUpperCase().indexOf(filter) > -1 ||
                    txtCategoria.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = '';
                } else {
                    tr[i].style.display = 'none';
                }
            }
        }
    }
</script>
{% endblock %}